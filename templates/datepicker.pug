extends ./base/layout

block title
  title Backbone-Forms jQueryUI datepicker example

block menu
  +menu('datepicker')

block extraheaders
  script(type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js")
  script(type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js")
  script(type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/backbone.js/1.3.3/backbone-min.js")
  script(type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/backbone-forms/0.14.0/backbone-forms.min.js")
  script(type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.0/jquery-ui.min.js")
  script(type="text/javascript" src="datepicker.js")
  link(rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/backbone-forms/0.14.0/templates/bootstrap3.css")
  link(rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.0/jquery-ui.min.css")
  link(rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.0/jquery-ui.theme.min.css")
  link(rel="stylesheet" href="jquery-ui.css")
  script(type="text/javascript").
    var loaded = false;
    var example = function () {
      if(loaded) return;
      loaded = true;
      var form = new Backbone.Form({
        model: new Backbone.Model({
          date: new Date(2018, 0, 1)
        }),
        schema: {
          date: {
            type: 'jqueryui.datepicker',
            title: 'Date',
            editorOptions: {
              numberOfMonths: [2, 3]
            }
          }
        }
      });
      var editor = form.getEditor('date');
      editor.on('change', function(editor) {
        $('.change span').html(editor.getValue().toLocaleFormat('%Y-%m-%d'));
      }).on('focus', function(editor) {
        $('.focus').removeClass('hidden');
        $('.blur').addClass('hidden');
      }).on('blur', function(editor) {
        $('.focus').addClass('hidden');
        $('.blur').removeClass('hidden');
      });
      $('#form').html(form.render().$el);
      editor.trigger('change', editor).trigger('blur', editor);
    };
    document.addEventListener("DOMContentLoaded", example, false);
    window.addEventListener("load", example, false);

block content
  .container
    .row
      h3 jqueryui.datepicker
      .col-md-6
        #form(style="padding-bottom: 10px;")
      .col-md-6
        p
          span.focus.label.label-success.hidden focus
          span.blur.label.label-success.hidden blur
        p.change
          span.label.label-primary
